[
  {
    "objectID": "posts/2024-12-05_idea_update/idea-update.html#section",
    "href": "posts/2024-12-05_idea_update/idea-update.html#section",
    "title": "IDEA - data and software",
    "section": "",
    "text": "raadtools, software to extract maps of ocean properties and values at points-in-time"
  },
  {
    "objectID": "posts/2024-12-05_idea_update/idea-update.html#raadtools-10-years-old-r-package",
    "href": "posts/2024-12-05_idea_update/idea-update.html#raadtools-10-years-old-r-package",
    "title": "IDEA - data and software",
    "section": "raadtools > 10 years old R package",
    "text": "raadtools &gt; 10 years old R package\n\n\n\n\n\n\n\nR function\nPurpose\n\n\n\n\nreadsst()\nglobal sea surface temperature\n\n\nreadice()\npolar sea ice concentrations\n\n\nreadghrsst()\nhigh resolution sea surface temperature\n\n\nread_adt/ugos/vgos_daily()\nglobal altimetry, sea height, surface currents\n\n\nread_chla_daily()\nglobal ocean colour\n\n\nreadtopo()\nglobal or local bathymetry\n\n\n‚Ä¶\n\n\n\n\nother functions we don‚Äôt have, yet ‚Ä¶"
  },
  {
    "objectID": "posts/2024-12-05_idea_update/idea-update.html#software-we-want",
    "href": "posts/2024-12-05_idea_update/idea-update.html#software-we-want",
    "title": "IDEA - data and software",
    "section": "software we want",
    "text": "software we want\n\n\n\nfeatures we want\nraadtools ü§î\n&lt;new tool&gt;\n\n\n\n\nusers don‚Äôt download files\n‚úÖ\n‚úÖ\n\n\ndata is up to date\n‚úÖ\n‚úÖ\n\n\nwe can add new data\n‚úÖ\n‚úÖ\n\n\nyou can add new data\n‚ùå\n‚úÖ\n\n\nuse outside AAD without Mike or Ben\n‚ùå\n‚úÖ\n\n\nuse outside of R\n‚ùå\n‚úÖ\n\n\nscale up on super computing\n‚ùå\n‚úÖ\n\n\nrobust to research/local outage\n‚ùå\n‚úÖ\n\n\navailable offline on Nuyina\n‚ùå\n??"
  },
  {
    "objectID": "posts/2024-12-05_idea_update/idea-update.html#python-support",
    "href": "posts/2024-12-05_idea_update/idea-update.html#python-support",
    "title": "IDEA - data and software",
    "section": "Python support",
    "text": "Python support\nAddress entire data cubes, with one line of code e.g.¬†daily data 1993 to November 2024\nimport xarray; &lt;some settings&gt;\n\nds = xarray.open_dataset('s3://vzarr/SEALEVEL_GLO_PHY_L4.parquet', &lt;more settings&gt;)\n&lt;xarray.Dataset&gt; Size: 574GB\nDimensions:    (time: 11538, latitude: 720, longitude: 1440)\nCoordinates:\n  * latitude   (latitude) float32 3kB -89.88 -89.62 -89.38 ... 89.38 89.62 89.88\n  * longitude  (longitude) float32 6kB -179.9 -179.6 -179.4 ... 179.6 179.9\n  * time       (time) datetime64[ns] 92kB 1993-01-01 1993-01-02 ... 2024-11-25\nData variables:\n    adt        (time, latitude, longitude) float64 96GB dask.array&lt;chunksize=(1, 50, 50), meta=np.ndarray&gt;\n    sla        (time, latitude, longitude) float64 96GB dask.array&lt;chunksize=(1, 50, 50), meta=np.ndarray&gt;\n    ugos       (time, latitude, longitude) float64 96GB dask.array&lt;chunksize=(1, 50, 50), meta=np.ndarray&gt;\n    ugosa      (time, latitude, longitude) float64 96GB dask.array&lt;chunksize=(1, 50, 50), meta=np.ndarray&gt;\n    vgos       (time, latitude, longitude) float64 96GB dask.array&lt;chunksize=(1, 50, 50), meta=np.ndarray&gt;\n    vgosa      (time, latitude, longitude) float64 96GB dask.array&lt;chunksize=(1, 50, 50), meta=np.ndarray&gt;\nAttributes: (12/44) ..."
  },
  {
    "objectID": "posts/2024-12-05_idea_update/idea-update.html#how-are-we-doing-this",
    "href": "posts/2024-12-05_idea_update/idea-update.html#how-are-we-doing-this",
    "title": "IDEA - data and software",
    "section": "How are we doing this",
    "text": "How are we doing this\n\nThe old and new tools reflect user-demand, tell us your ideas!\nModern tech: cloud-native and efficient public-available files\nData curation and cataloguing tools: {bowerbird}, STAC, VirtualiZarr\nExploring best-practice usage in Python xarray, odc, and in R terra, gdalraster, rsi\nContributing to software libraries GDAL.org, and community with AADC, SCAR, rOpenSci, Pangeo, Radiant Earth, Opendatacube, Digital Earth Antarctica"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "hypertidy-blog",
    "section": "",
    "text": "Coordinates broken in NetCDF\n\n\n\n\n\n\nnews\n\n\ncode\n\n\n\n\n\n\n\n\n\nSep 4, 2025\n\n\nMichael Sumner\n\n\n\n\n\n\n\n\n\n\n\n\nGDAL multidim and cloud-ready ZARR\n\n\n\n\n\n\n\n\n\n\n\nJun 30, 2025\n\n\nMichael Sumner\n\n\n\n\n\n\n\n\n\n\n\n\nConservative regridding with GDAL (?)\n\n\n\n\n\n\nnews\n\n\ncode\n\n\n\n\n\n\n\n\n\nDec 11, 2024\n\n\nMichael Sumner\n\n\n\n\n\n\n\n\n\n\n\n\nIDEA - data and software\n\n\n\n\n\n\n\n\n\n\n\nDec 5, 2024\n\n\nMichael Sumner\n\n\n\n\n\n\n\n\n\n\n\n\nPlot at native resolution, with R\n\n\n\n\n\n\nnews\n\n\ncode\n\n\n\n\n\n\n\n\n\nDec 4, 2024\n\n\nMichael D. Sumner\n\n\n\n\n\n\n\n\n\n\n\n\nGDAL and image tiles, the {ceramic} package\n\n\n\n\n\n\nnews\n\n\ncode\n\n\n\n\n\n\n\n\n\nApr 22, 2023\n\n\nMichael D. Sumner\n\n\n\n\n\n\n\n\n\n\n\n\nDegenerate Rectilinear (WIP)\n\n\n\n\n\n\nnews\n\n\ncode\n\n\n\n\n\n\n\n\n\nDec 9, 2022\n\n\nMichael D. Sumner\n\n\n\n\n\n\n\n\n\n\n\n\nGDAL raster read/write by blocks\n\n\n\n\n\n\nnews\n\n\ncode\n\n\n\n\n\n\n\n\n\nMay 4, 2022\n\n\nMichael D. Sumner\n\n\n\n\n\n\n\n\n\n\n\n\nGDAL warper with R\n\n\n\n\n\n\nnews\n\n\ncode\n\n\n\n\n\n\n\n\n\nApr 25, 2022\n\n\nMichael D. Sumner\n\n\n\n\n\n\n\n\n\n\n\n\nmesh3d - recent changes in rgl workhorse format\n\n\n\n\n\n\nnews\n\n\ncode\n\n\n\n\n\n\n\n\n\nMay 29, 2019\n\n\nMichael D. Sumner\n\n\n\n\n\n\n\n\n\n\n\n\nGDAL in R\n\n\n\n\n\n\nnews\n\n\ncode\n\n\n\n\n\n\n\n\n\nSep 1, 2017\n\n\nMichael D. Sumner\n\n\n\n\n\n\n\n\n\n\n\n\nWeb services for scientific data in R\n\n\n\n\n\n\nnews\n\n\ncode\n\n\n\n\n\n\n\n\n\nJul 25, 2017\n\n\nMichael D. Sumner\n\n\n\n\n\n\n\n\n\n\n\n\nR spatial in 2017\n\n\n\n\n\n\nnews\n\n\ncode\n\n\n\n\n\n\n\n\n\nJan 10, 2017\n\n\nMichael D. Sumner\n\n\n\n\n\n\n\n\n\n\n\n\nGIS for 3D in R\n\n\n\n\n\n\nnews\n\n\ncode\n\n\n\n\n\n\n\n\n\nDec 28, 2015\n\n\nMichael D. Sumner\n\n\n\n\n\n\n\n\n\n\n\n\nR matrices and image\n\n\n\n\n\n\ncode\n\n\n\n\n\n\n\n\n\nApr 17, 2014\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "posts/2025-09-04_broken-netcdf/index.html",
    "href": "posts/2025-09-04_broken-netcdf/index.html",
    "title": "Coordinates broken in NetCDF",
    "section": "",
    "text": "There‚Äôs a NetCDF file at this URL:\n\"https://zenodo.org/records/7327711/files/CS2WFA_25km_201007.nc?download=1\"\nIt‚Äôs fairly straightforward:\nnetcdf CS2WFA_25km_201007 {\ndimensions:\n        y = 332 ;\n        x = 316 ;\n        time = 1 ;\nvariables:\n        float time(time) ;\n                time:long_name = \"time\" ;\n                time:units = \"months since 2000-01-01\" ;\n                time:calendar = \"360_day\" ;\n        double lat(y, x) ;\n                lat:long_name = \"latitude\" ;\n                lat:units = \"degrees_north\" ;\n        double lon(y, x) ;\n                lon:long_name = \"longitude\" ;\n                lon:units = \"degrees_east\" ;\n...\n        double sea_ice_concentration(time, y, x) ;\n                sea_ice_concentration:least_significant_digit = 4LL ;\n                sea_ice_concentration:units = \"1\" ;\n                sea_ice_concentration:standard_name = \"sea_ice_area_fraction\" ;\n                sea_ice_concentration:description = \"Mean sea ice concentration in grid cell, from Bootstrap V3 concentration algorithm (Comiso, 2017 https://doi.org/10.5067/7Q8HCCWS4I0R)\" ;\n\n// global attributes:\n                :title = \"Antarctic sea ice physical properties obtained from CryoSat-2 using the CS2WFA algorithm\" ;\n                :institution = \"NASA GSFC Cryospheric Sciences Laboratory and University of Maryland-College Park\" ;\n                :history = \"File created on November 15, 2022, 12:09:06\" ;\n\ngroup: sea_ice_thickness {\n  ...\ngroup: density {\n  variables:\n        double ice_density(time, y, x) ;\n                ice_density:least_significant_digit = 4LL ;\n ...\n  } // group density\n}\nThere‚Äôs a root group with four variables defined in time,y,x and another two groups with further variables on that same grid.\nEach data array is 316x332x1 and we can tell that every lon,lat pair is stored explicitly. This fits a convention in NetCDF where time is ‚Äúunlimited‚Äù and we‚Äôre only looking at a subset of an overall time series, that could well be continually generated day to day still now.\nLet‚Äôs investigate the coordinates. We‚Äôll use GDAL via a commonly used wrapper in R, its ‚Äòvsicurl‚Äô protocol to stream from the internet, and declare the driver explicitly (lest we get the less sophisticated HDF5 interpretation).\n\n#dsn &lt;- \"NETCDF:/vsicurl/https://zenodo.org/records/7327711/files/CS2WFA_25km_201007.nc?download=1\"\ndsn &lt;- \"NETCDF:../CS2WFA_25km_201007.nc\"\nlibrary(terra)\n\nterra 1.8.62\n\nlon &lt;- rast(dsn, \"lon\")\n\nWarning: [rast] GDAL did not find an extent. installing the ncdf4 package may\nhelp\n\nlat &lt;- rast(dsn, \"lat\")\n\nWarning: [rast] GDAL did not find an extent. installing the ncdf4 package may\nhelp\n\nplot(c(lon, lat))\n\n\n\n\n\n\n\n\nWe get a message from terra about ‚Äúcells not equally spaced‚Äù, which means that when reading an array the geospatial context in GDAL didn‚Äôt find anything specifying a compact representation of coordinates, but lon and lat are the coordinates as data, so we can safely ignore this message. (There‚Äôs another message about ncdf4, but ignore that too it‚Äôs terra try(ing) stuff. )\nWe won‚Äôt pay attention to ‚Äútime‚Äù, because our file only has one time step. We‚Äôre interested in these lon,lat coordinates. What does the data itself look like? Again we choose one of the 3D variables (with degenerate 3rd dimension ‚Äòtime‚Äô) by name.\n\nice &lt;- rast(dsn, \"sea_ice_concentration\")\n\nWarning: [rast] GDAL did not find an extent. installing the ncdf4 package may\nhelp\n\nplot(ice)\n\n\n\n\n\n\n\n\nThat should look familiar, though notice that we don‚Äôt have any spatial information it‚Äôs just a matrix in its own index coordinates, 0,316 for x and 0,332 for y.\nLet‚Äôs plot the coordinates. Now we can see our data in a much more spatial-ish context.\n\nxyz &lt;- values(c(lon, lat, ice))\nplot(xyz[,1:2], pch = \".\", col = palr::d_pal(xyz[,3]), asp = 2)\nmaps::map(\"world2\", add = TRUE)\n\n\n\n\n\n\n\n\nWe now don‚Äôt have a nice gridded dataset, it‚Äôs points in longitude latitude. What can we do to plot it in that nice polar aspect with proper spatial referencing?\nLet‚Äôs have a look at this dataset from a GDAL perspective. Now we use the API package gdalraster which gives a lot more control over GDAL itself. I‚Äôm going to skip over interrogating the syntax for a particular array, like we did with terra and ‚Äòsea_ice_concentration‚Äô above, I construct the subdataset syntax to open.\n\n\"NETCDF:/vsicurl/https://zenodo.org/records/7327711/files/CS2WFA_25km_201007.nc?download=1\"\n\n[1] \"NETCDF:/vsicurl/https://zenodo.org/records/7327711/files/CS2WFA_25km_201007.nc?download=1\"\n\nsds &lt;- sprintf(\"%s:sea_ice_concentration\", dsn)\nlibrary(gdalraster)\n\nGDAL 3.12.0dev-4e2b27da8f (released 2025-08-26), GEOS 3.12.1, PROJ 9.3.1\n\n\n\nAttaching package: 'gdalraster'\n\n\nThe following object is masked from 'package:terra':\n\n    rasterize\n\nds &lt;- new(GDALRaster, sds)\nds$info()\n\nDriver: netCDF/Network Common Data Format\nFiles: ../CS2WFA_25km_201007.nc\nSize is 316, 332\nMetadata:\n  NC_GLOBAL#history=File created on November 15, 2022, 12:09:06\n  NC_GLOBAL#institution=NASA GSFC Cryospheric Sciences Laboratory and University of Maryland-College Park\n  NC_GLOBAL#title=Antarctic sea ice physical properties obtained from CryoSat-2 using the CS2WFA algorithm\n  NETCDF_DIM_EXTRA={time}\n  NETCDF_DIM_time_DEF={1,5}\n  NETCDF_DIM_time_VALUES=126\n  sea_ice_concentration#description=Mean sea ice concentration in grid cell, from Bootstrap V3 concentration algorithm (Comiso, 2017 https://doi.org/10.5067/7Q8HCCWS4I0R)\n  sea_ice_concentration#least_significant_digit=4\n  sea_ice_concentration#standard_name=sea_ice_area_fraction\n  sea_ice_concentration#units=1\n  time#calendar=360_day\n  time#long_name=time\n  time#units=months since 2000-01-01\nGeolocation:\n  SRS=GEOGCS[\"WGS 84\",DATUM[\"WGS_1984\",SPHEROID[\"WGS 84\",6378137,298.257223563,AUTHORITY[\"EPSG\",\"7030\"]],AUTHORITY[\"EPSG\",\"6326\"]],PRIMEM[\"Greenwich\",0,AUTHORITY[\"EPSG\",\"8901\"]],UNIT[\"degree\",0.0174532925199433,AUTHORITY[\"EPSG\",\"9122\"]],AXIS[\"Latitude\",NORTH],AXIS[\"Longitude\",EAST],AUTHORITY[\"EPSG\",\"4326\"]]\n  X_DATASET=NETCDF:\"../CS2WFA_25km_201007.nc\":lon\n  X_BAND=1\n  Y_DATASET=NETCDF:\"../CS2WFA_25km_201007.nc\":lat\n  Y_BAND=1\n  PIXEL_OFFSET=0\n  PIXEL_STEP=1\n  LINE_OFFSET=0\n  LINE_STEP=1\n  GEOREFERENCING_CONVENTION=PIXEL_CENTER\nCorner Coordinates:\nUpper Left  (    0.0,    0.0)\nLower Left  (    0.0,  332.0)\nUpper Right (  316.0,    0.0)\nLower Right (  316.0,  332.0)\nCenter      (  158.0,  166.0)\nBand 1 Block=316x332 Type=Float64, ColorInterp=Undefined\n  NoData Value=9.969209968386869e+36\n  Unit Type: 1\n  Metadata:\n    NETCDF_VARNAME=sea_ice_concentration\n    least_significant_digit=4\n    units=1\n    standard_name=sea_ice_area_fraction\n    description=Mean sea ice concentration in grid cell, from Bootstrap V3 concentration algorithm (Comiso, 2017 https://doi.org/10.5067/7Q8HCCWS4I0R)\n    NETCDF_DIM_time=126\n\n\nThe interesting part of that output is under ‚ÄúGeolocation:‚Äù. We can see that while GDAL doesn‚Äôt have spatial referencing for this array, it does seem to know that‚Äôs it‚Äôs possible because of the X_DATASET and Y_DATASET. These can be used by the GDAL warper API (warp means ‚Äúreprojection‚Äù or ‚Äúreshaping‚Äù for an image) in order to resolve to a new spatial gridded dataset ‚Ä¶ but also note, the same facilities used to ‚Äúreproject‚Äù one regular grid to another are also the same that can be used to generate a regular grid from irregular geolocation coordinates (we have a point for every data point, but those coordinates might be less dense, or might be GCPs or RCPs, and no matter what coordinate system those latent coordinates are using, we can warp to whatever spatial grid we like). So let‚Äôs warp.\nWe don‚Äôt have to specifying the geolocation arrays, we saw that GDAL already knows this. We‚Äôll write our new gridded dataset conveniently to a temporary virtual ‚Äúfile‚Äù so we can avoid more cleanup.\n\ngdalraster::warp(sds,  tf &lt;- tempfile(fileext = \".tif\", tmpdir = \"/vsimem\"), t_srs = \"EPSG:4326\")\n\n0...10...20...30...40...50...60...70...80...90...100 - done.\n\nplot(icegrid &lt;- rast(tf))\n\n\n\n\n\n\n\nicegrid\n\nclass       : SpatRaster \nsize        : 127, 902, 1  (nrow, ncol, nlyr)\nresolution  : 0.398722, 0.3987662  (x, y)\nextent      : 0.164645, 359.8119, -89.80441, -39.1611  (xmin, xmax, ymin, ymax)\ncoord. ref. : lon/lat WGS 84 (EPSG:4326) \nsource      : filedb3943dea1d4.tif \nname        : filedb3943dea1d4 \n\n\nWe indeed now have a spatial grid, a raster. But perhaps we don‚Äôt like the 0,360 convention. We can set the target extent, GDAL had to figure one out from the input geolocation arrays, and it will usually do a good job but it‚Äôs really our responsibility to specify what we want for reproducibility in later workflows.\n\ngdalraster::warp(sds,  tf &lt;- tempfile(fileext = \".tif\", tmpdir = \"/vsimem\"), t_srs = \"EPSG:4326\", \n                 cl_arg = c(\"-te\", -180, -90, 180, -39, \"-to\", \"GEOLOC_NORMALIZE_LONGITUDE_MINUS_180_PLUS_180=YES\"))\n\n0...10...20...30...40...50...60...70...80...90...100 - done.\n\nplot(icegrid &lt;- rast(tf))\n\n\n\n\n\n\n\nicegrid\n\nclass       : SpatRaster \nsize        : 194, 1371, 1  (nrow, ncol, nlyr)\nresolution  : 0.2625821, 0.2628866  (x, y)\nextent      : -180, 180, -90, -39  (xmin, xmax, ymin, ymax)\ncoord. ref. : lon/lat WGS 84 (EPSG:4326) \nsource      : filedb394444fc021.tif \nname        : filedb394444fc021 \n\n\nAnother thing that is also our responsibility is the dimensions of the grid and the resolution, obviously this and extent (or bbox, bounding box) are all interlinked so we augment our bounding box / extent setting with a nice clean resolution.\n\ngdalraster::warp(sds,  tf &lt;- tempfile(fileext = \".tif\", tmpdir = \"/vsimem\"), t_srs = \"EPSG:4326\", \n                 cl_arg = c(\"-te\", -180, -90, 180, -39, \"-tr\", 0.25, 0.25,\n                            \"-to\", \"GEOLOC_NORMALIZE_LONGITUDE_MINUS_180_PLUS_180=YES\"))\n\n0...10...20...30...40...50...60...70...80...90...100 - done.\n\nplot(icegrid &lt;- rast(tf))\nmaps::map(add = TRUE)\n\n\n\n\n\n\n\nicegrid\n\nclass       : SpatRaster \nsize        : 204, 1440, 1  (nrow, ncol, nlyr)\nresolution  : 0.25, 0.25  (x, y)\nextent      : -180, 180, -90, -39  (xmin, xmax, ymin, ymax)\ncoord. ref. : lon/lat WGS 84 (EPSG:4326) \nsource      : filedb39443fd3375.tif \nname        : filedb39443fd3375 \n\n\nThat is all well and nice, and we‚Äôve quietly demonstrated some of the key powers of GDAL:\n\nvirtualization, streaming read, read a particular variable\ninvestigate GDAL logic (coordinates are linked to data via latent ‚Äúgeolocation‚Äù arrays)\nwarping with heuristics to a CRS\nwarping with a grid specification, and using geolocation arrays to guide the grid-resolving process\nsetting grid specification with any of crs, extent(bbox), resolution, dimension, and allowing GDAL to internally wrap from 0,360 context to -180,180\n\nBut, we still don‚Äôt have that nice polar aspect we saw from the raw array above. So we change CRS. ‚ÄòEPSG:3412‚Äô is a Polar Stereographic map projection on the south pole, commonly used for standard sea ice products. As a grid this has nice properties, that don‚Äôt require edge-wrap for a matrix model, it‚Äôs true scale at approximately where the coastline of Antarctica is, and it preserves shape (this means not all cells are exactly the same size, but they‚Äôre close enough for where the sea ice is).\n\ngdalraster::warp(sds,  tf &lt;- tempfile(fileext = \".tif\", tmpdir = \"/vsimem\"), t_srs = \"EPSG:3412\", \n                cl_arg = c(\"-to\", \"GEOLOC_NORMALIZE_LONGITUDE_MINUS_180_PLUS_180=YES\"))\n\n0...10...20...30...40...50...60...70...80...90...100 - done.\n\nplot(polargrid &lt;- rast(tf))\n\n\n\n\n\n\n\npolargrid\n\nclass       : SpatRaster \nsize        : 348, 332, 1  (nrow, ncol, nlyr)\nresolution  : 24999.84, 24999.84  (x, y)\nextent      : -3950080, 4349868, -4337584, 4362361  (xmin, xmax, ymin, ymax)\ncoord. ref. : NSIDC Sea Ice Polar Stereographic South (EPSG:3412) \nsource      : filedb39427e3e998.tif \nname        : filedb39427e3e998 \n\n\nTo make sure let‚Äôs get some spatial data to plot with this.\n\nv &lt;- vect(\"/vsizip//vsicurl/https://github.com/wmgeolab/geoBoundaries/raw/main/releaseData/CGAZ/geoBoundariesCGAZ_ADM0.zip\", \n     query = \"SELECT shapeGroup FROM geoBoundariesCGAZ_ADM0 WHERE shapeGroup IN ('ATA')\")\nv &lt;- crop(v, ext(-180, 180, -84, 0)) ## small hack to remove the pole seam\nv &lt;- project(v, \"EPSG:3412\")\nplot(polargrid)\nplot(v, add = TRUE)\n\n\n\n\n\n\n\n\nLooks good! We‚Äôve plotted the original data in the correct polar aspect.\nBut, the data aren‚Äôt exactly the same, we‚Äôve added pixels in the heuristic used by GDAL to determine the grid specification from the extent and resolution of the geolocation array longitude and latitudes.\n\nice\n\nclass       : SpatRaster \nsize        : 332, 316, 1  (nrow, ncol, nlyr)\nresolution  : 1, 1  (x, y)\nextent      : 0, 316, 0, 332  (xmin, xmax, ymin, ymax)\ncoord. ref. :  \nsource      : CS2WFA_25km_201007.nc:sea_ice_concentration \nvarname     : sea_ice_concentration (sea_ice_area_fraction) \nname        : sea_ice_concentration \nunit        :                     1 \n\npolargrid\n\nclass       : SpatRaster \nsize        : 348, 332, 1  (nrow, ncol, nlyr)\nresolution  : 24999.84, 24999.84  (x, y)\nextent      : -3950080, 4349868, -4337584, 4362361  (xmin, xmax, ymin, ymax)\ncoord. ref. : NSIDC Sea Ice Polar Stereographic South (EPSG:3412) \nsource      : filedb39427e3e998.tif \nname        : filedb39427e3e998 \n\n\nSo, let‚Äôs try to use the same grid.\n\ngdalraster::warp(sds,  tf &lt;- tempfile(fileext = \".tif\", tmpdir = \"/vsimem\"), t_srs = \"EPSG:3412\", \n                cl_arg = c(\"-ts\", 316, 332,\n                           \n                  \"-to\", \"GEOLOC_NORMALIZE_LONGITUDE_MINUS_180_PLUS_180=YES\"))\n\n0...10...20...30...40...50...60...70...80...90...100 - done.\n\npolargrid &lt;- rast(tf)\n\npolargrid\n\nclass       : SpatRaster \nsize        : 332, 316, 1  (nrow, ncol, nlyr)\nresolution  : 26265.66, 26204.65  (x, y)\nextent      : -3950080, 4349868, -4337584, 4362361  (xmin, xmax, ymin, ymax)\ncoord. ref. : NSIDC Sea Ice Polar Stereographic South (EPSG:3412) \nsource      : filedb394ad7590c.tif \nname        : filedb394ad7590c \n\n\nWe can‚Äôt do that without giving them the same extent, but we still don‚Äôt know what that is for the original data. So let‚Äôs calculate it.\n\nxy &lt;- project(values(c(lon, lat)), to = \"EPSG:3412\", from = \"EPSG:4326\")\nrange(xy[,2])\n\n[1] -3937527  4337533"
  },
  {
    "objectID": "posts/2025-09-04_broken-netcdf/index.html#a-netcdf-file",
    "href": "posts/2025-09-04_broken-netcdf/index.html#a-netcdf-file",
    "title": "Coordinates broken in NetCDF",
    "section": "",
    "text": "There‚Äôs a NetCDF file at this URL:\n\"https://zenodo.org/records/7327711/files/CS2WFA_25km_201007.nc?download=1\"\nIt‚Äôs fairly straightforward:\nnetcdf CS2WFA_25km_201007 {\ndimensions:\n        y = 332 ;\n        x = 316 ;\n        time = 1 ;\nvariables:\n        float time(time) ;\n                time:long_name = \"time\" ;\n                time:units = \"months since 2000-01-01\" ;\n                time:calendar = \"360_day\" ;\n        double lat(y, x) ;\n                lat:long_name = \"latitude\" ;\n                lat:units = \"degrees_north\" ;\n        double lon(y, x) ;\n                lon:long_name = \"longitude\" ;\n                lon:units = \"degrees_east\" ;\n...\n        double sea_ice_concentration(time, y, x) ;\n                sea_ice_concentration:least_significant_digit = 4LL ;\n                sea_ice_concentration:units = \"1\" ;\n                sea_ice_concentration:standard_name = \"sea_ice_area_fraction\" ;\n                sea_ice_concentration:description = \"Mean sea ice concentration in grid cell, from Bootstrap V3 concentration algorithm (Comiso, 2017 https://doi.org/10.5067/7Q8HCCWS4I0R)\" ;\n\n// global attributes:\n                :title = \"Antarctic sea ice physical properties obtained from CryoSat-2 using the CS2WFA algorithm\" ;\n                :institution = \"NASA GSFC Cryospheric Sciences Laboratory and University of Maryland-College Park\" ;\n                :history = \"File created on November 15, 2022, 12:09:06\" ;\n\ngroup: sea_ice_thickness {\n  ...\ngroup: density {\n  variables:\n        double ice_density(time, y, x) ;\n                ice_density:least_significant_digit = 4LL ;\n ...\n  } // group density\n}\nThere‚Äôs a root group with four variables defined in time,y,x and another two groups with further variables on that same grid.\nEach data array is 316x332x1 and we can tell that every lon,lat pair is stored explicitly. This fits a convention in NetCDF where time is ‚Äúunlimited‚Äù and we‚Äôre only looking at a subset of an overall time series, that could well be continually generated day to day still now.\nLet‚Äôs investigate the coordinates. We‚Äôll use GDAL via a commonly used wrapper in R, its ‚Äòvsicurl‚Äô protocol to stream from the internet, and declare the driver explicitly (lest we get the less sophisticated HDF5 interpretation).\n\n#dsn &lt;- \"NETCDF:/vsicurl/https://zenodo.org/records/7327711/files/CS2WFA_25km_201007.nc?download=1\"\ndsn &lt;- \"NETCDF:../CS2WFA_25km_201007.nc\"\nlibrary(terra)\n\nterra 1.8.62\n\nlon &lt;- rast(dsn, \"lon\")\n\nWarning: [rast] GDAL did not find an extent. installing the ncdf4 package may\nhelp\n\nlat &lt;- rast(dsn, \"lat\")\n\nWarning: [rast] GDAL did not find an extent. installing the ncdf4 package may\nhelp\n\nplot(c(lon, lat))\n\n\n\n\n\n\n\n\nWe get a message from terra about ‚Äúcells not equally spaced‚Äù, which means that when reading an array the geospatial context in GDAL didn‚Äôt find anything specifying a compact representation of coordinates, but lon and lat are the coordinates as data, so we can safely ignore this message. (There‚Äôs another message about ncdf4, but ignore that too it‚Äôs terra try(ing) stuff. )\nWe won‚Äôt pay attention to ‚Äútime‚Äù, because our file only has one time step. We‚Äôre interested in these lon,lat coordinates. What does the data itself look like? Again we choose one of the 3D variables (with degenerate 3rd dimension ‚Äòtime‚Äô) by name.\n\nice &lt;- rast(dsn, \"sea_ice_concentration\")\n\nWarning: [rast] GDAL did not find an extent. installing the ncdf4 package may\nhelp\n\nplot(ice)\n\n\n\n\n\n\n\n\nThat should look familiar, though notice that we don‚Äôt have any spatial information it‚Äôs just a matrix in its own index coordinates, 0,316 for x and 0,332 for y.\nLet‚Äôs plot the coordinates. Now we can see our data in a much more spatial-ish context.\n\nxyz &lt;- values(c(lon, lat, ice))\nplot(xyz[,1:2], pch = \".\", col = palr::d_pal(xyz[,3]), asp = 2)\nmaps::map(\"world2\", add = TRUE)\n\n\n\n\n\n\n\n\nWe now don‚Äôt have a nice gridded dataset, it‚Äôs points in longitude latitude. What can we do to plot it in that nice polar aspect with proper spatial referencing?\nLet‚Äôs have a look at this dataset from a GDAL perspective. Now we use the API package gdalraster which gives a lot more control over GDAL itself. I‚Äôm going to skip over interrogating the syntax for a particular array, like we did with terra and ‚Äòsea_ice_concentration‚Äô above, I construct the subdataset syntax to open.\n\n\"NETCDF:/vsicurl/https://zenodo.org/records/7327711/files/CS2WFA_25km_201007.nc?download=1\"\n\n[1] \"NETCDF:/vsicurl/https://zenodo.org/records/7327711/files/CS2WFA_25km_201007.nc?download=1\"\n\nsds &lt;- sprintf(\"%s:sea_ice_concentration\", dsn)\nlibrary(gdalraster)\n\nGDAL 3.12.0dev-4e2b27da8f (released 2025-08-26), GEOS 3.12.1, PROJ 9.3.1\n\n\n\nAttaching package: 'gdalraster'\n\n\nThe following object is masked from 'package:terra':\n\n    rasterize\n\nds &lt;- new(GDALRaster, sds)\nds$info()\n\nDriver: netCDF/Network Common Data Format\nFiles: ../CS2WFA_25km_201007.nc\nSize is 316, 332\nMetadata:\n  NC_GLOBAL#history=File created on November 15, 2022, 12:09:06\n  NC_GLOBAL#institution=NASA GSFC Cryospheric Sciences Laboratory and University of Maryland-College Park\n  NC_GLOBAL#title=Antarctic sea ice physical properties obtained from CryoSat-2 using the CS2WFA algorithm\n  NETCDF_DIM_EXTRA={time}\n  NETCDF_DIM_time_DEF={1,5}\n  NETCDF_DIM_time_VALUES=126\n  sea_ice_concentration#description=Mean sea ice concentration in grid cell, from Bootstrap V3 concentration algorithm (Comiso, 2017 https://doi.org/10.5067/7Q8HCCWS4I0R)\n  sea_ice_concentration#least_significant_digit=4\n  sea_ice_concentration#standard_name=sea_ice_area_fraction\n  sea_ice_concentration#units=1\n  time#calendar=360_day\n  time#long_name=time\n  time#units=months since 2000-01-01\nGeolocation:\n  SRS=GEOGCS[\"WGS 84\",DATUM[\"WGS_1984\",SPHEROID[\"WGS 84\",6378137,298.257223563,AUTHORITY[\"EPSG\",\"7030\"]],AUTHORITY[\"EPSG\",\"6326\"]],PRIMEM[\"Greenwich\",0,AUTHORITY[\"EPSG\",\"8901\"]],UNIT[\"degree\",0.0174532925199433,AUTHORITY[\"EPSG\",\"9122\"]],AXIS[\"Latitude\",NORTH],AXIS[\"Longitude\",EAST],AUTHORITY[\"EPSG\",\"4326\"]]\n  X_DATASET=NETCDF:\"../CS2WFA_25km_201007.nc\":lon\n  X_BAND=1\n  Y_DATASET=NETCDF:\"../CS2WFA_25km_201007.nc\":lat\n  Y_BAND=1\n  PIXEL_OFFSET=0\n  PIXEL_STEP=1\n  LINE_OFFSET=0\n  LINE_STEP=1\n  GEOREFERENCING_CONVENTION=PIXEL_CENTER\nCorner Coordinates:\nUpper Left  (    0.0,    0.0)\nLower Left  (    0.0,  332.0)\nUpper Right (  316.0,    0.0)\nLower Right (  316.0,  332.0)\nCenter      (  158.0,  166.0)\nBand 1 Block=316x332 Type=Float64, ColorInterp=Undefined\n  NoData Value=9.969209968386869e+36\n  Unit Type: 1\n  Metadata:\n    NETCDF_VARNAME=sea_ice_concentration\n    least_significant_digit=4\n    units=1\n    standard_name=sea_ice_area_fraction\n    description=Mean sea ice concentration in grid cell, from Bootstrap V3 concentration algorithm (Comiso, 2017 https://doi.org/10.5067/7Q8HCCWS4I0R)\n    NETCDF_DIM_time=126\n\n\nThe interesting part of that output is under ‚ÄúGeolocation:‚Äù. We can see that while GDAL doesn‚Äôt have spatial referencing for this array, it does seem to know that‚Äôs it‚Äôs possible because of the X_DATASET and Y_DATASET. These can be used by the GDAL warper API (warp means ‚Äúreprojection‚Äù or ‚Äúreshaping‚Äù for an image) in order to resolve to a new spatial gridded dataset ‚Ä¶ but also note, the same facilities used to ‚Äúreproject‚Äù one regular grid to another are also the same that can be used to generate a regular grid from irregular geolocation coordinates (we have a point for every data point, but those coordinates might be less dense, or might be GCPs or RCPs, and no matter what coordinate system those latent coordinates are using, we can warp to whatever spatial grid we like). So let‚Äôs warp.\nWe don‚Äôt have to specifying the geolocation arrays, we saw that GDAL already knows this. We‚Äôll write our new gridded dataset conveniently to a temporary virtual ‚Äúfile‚Äù so we can avoid more cleanup.\n\ngdalraster::warp(sds,  tf &lt;- tempfile(fileext = \".tif\", tmpdir = \"/vsimem\"), t_srs = \"EPSG:4326\")\n\n0...10...20...30...40...50...60...70...80...90...100 - done.\n\nplot(icegrid &lt;- rast(tf))\n\n\n\n\n\n\n\nicegrid\n\nclass       : SpatRaster \nsize        : 127, 902, 1  (nrow, ncol, nlyr)\nresolution  : 0.398722, 0.3987662  (x, y)\nextent      : 0.164645, 359.8119, -89.80441, -39.1611  (xmin, xmax, ymin, ymax)\ncoord. ref. : lon/lat WGS 84 (EPSG:4326) \nsource      : filedb3943dea1d4.tif \nname        : filedb3943dea1d4 \n\n\nWe indeed now have a spatial grid, a raster. But perhaps we don‚Äôt like the 0,360 convention. We can set the target extent, GDAL had to figure one out from the input geolocation arrays, and it will usually do a good job but it‚Äôs really our responsibility to specify what we want for reproducibility in later workflows.\n\ngdalraster::warp(sds,  tf &lt;- tempfile(fileext = \".tif\", tmpdir = \"/vsimem\"), t_srs = \"EPSG:4326\", \n                 cl_arg = c(\"-te\", -180, -90, 180, -39, \"-to\", \"GEOLOC_NORMALIZE_LONGITUDE_MINUS_180_PLUS_180=YES\"))\n\n0...10...20...30...40...50...60...70...80...90...100 - done.\n\nplot(icegrid &lt;- rast(tf))\n\n\n\n\n\n\n\nicegrid\n\nclass       : SpatRaster \nsize        : 194, 1371, 1  (nrow, ncol, nlyr)\nresolution  : 0.2625821, 0.2628866  (x, y)\nextent      : -180, 180, -90, -39  (xmin, xmax, ymin, ymax)\ncoord. ref. : lon/lat WGS 84 (EPSG:4326) \nsource      : filedb394444fc021.tif \nname        : filedb394444fc021 \n\n\nAnother thing that is also our responsibility is the dimensions of the grid and the resolution, obviously this and extent (or bbox, bounding box) are all interlinked so we augment our bounding box / extent setting with a nice clean resolution.\n\ngdalraster::warp(sds,  tf &lt;- tempfile(fileext = \".tif\", tmpdir = \"/vsimem\"), t_srs = \"EPSG:4326\", \n                 cl_arg = c(\"-te\", -180, -90, 180, -39, \"-tr\", 0.25, 0.25,\n                            \"-to\", \"GEOLOC_NORMALIZE_LONGITUDE_MINUS_180_PLUS_180=YES\"))\n\n0...10...20...30...40...50...60...70...80...90...100 - done.\n\nplot(icegrid &lt;- rast(tf))\nmaps::map(add = TRUE)\n\n\n\n\n\n\n\nicegrid\n\nclass       : SpatRaster \nsize        : 204, 1440, 1  (nrow, ncol, nlyr)\nresolution  : 0.25, 0.25  (x, y)\nextent      : -180, 180, -90, -39  (xmin, xmax, ymin, ymax)\ncoord. ref. : lon/lat WGS 84 (EPSG:4326) \nsource      : filedb39443fd3375.tif \nname        : filedb39443fd3375 \n\n\nThat is all well and nice, and we‚Äôve quietly demonstrated some of the key powers of GDAL:\n\nvirtualization, streaming read, read a particular variable\ninvestigate GDAL logic (coordinates are linked to data via latent ‚Äúgeolocation‚Äù arrays)\nwarping with heuristics to a CRS\nwarping with a grid specification, and using geolocation arrays to guide the grid-resolving process\nsetting grid specification with any of crs, extent(bbox), resolution, dimension, and allowing GDAL to internally wrap from 0,360 context to -180,180\n\nBut, we still don‚Äôt have that nice polar aspect we saw from the raw array above. So we change CRS. ‚ÄòEPSG:3412‚Äô is a Polar Stereographic map projection on the south pole, commonly used for standard sea ice products. As a grid this has nice properties, that don‚Äôt require edge-wrap for a matrix model, it‚Äôs true scale at approximately where the coastline of Antarctica is, and it preserves shape (this means not all cells are exactly the same size, but they‚Äôre close enough for where the sea ice is).\n\ngdalraster::warp(sds,  tf &lt;- tempfile(fileext = \".tif\", tmpdir = \"/vsimem\"), t_srs = \"EPSG:3412\", \n                cl_arg = c(\"-to\", \"GEOLOC_NORMALIZE_LONGITUDE_MINUS_180_PLUS_180=YES\"))\n\n0...10...20...30...40...50...60...70...80...90...100 - done.\n\nplot(polargrid &lt;- rast(tf))\n\n\n\n\n\n\n\npolargrid\n\nclass       : SpatRaster \nsize        : 348, 332, 1  (nrow, ncol, nlyr)\nresolution  : 24999.84, 24999.84  (x, y)\nextent      : -3950080, 4349868, -4337584, 4362361  (xmin, xmax, ymin, ymax)\ncoord. ref. : NSIDC Sea Ice Polar Stereographic South (EPSG:3412) \nsource      : filedb39427e3e998.tif \nname        : filedb39427e3e998 \n\n\nTo make sure let‚Äôs get some spatial data to plot with this.\n\nv &lt;- vect(\"/vsizip//vsicurl/https://github.com/wmgeolab/geoBoundaries/raw/main/releaseData/CGAZ/geoBoundariesCGAZ_ADM0.zip\", \n     query = \"SELECT shapeGroup FROM geoBoundariesCGAZ_ADM0 WHERE shapeGroup IN ('ATA')\")\nv &lt;- crop(v, ext(-180, 180, -84, 0)) ## small hack to remove the pole seam\nv &lt;- project(v, \"EPSG:3412\")\nplot(polargrid)\nplot(v, add = TRUE)\n\n\n\n\n\n\n\n\nLooks good! We‚Äôve plotted the original data in the correct polar aspect.\nBut, the data aren‚Äôt exactly the same, we‚Äôve added pixels in the heuristic used by GDAL to determine the grid specification from the extent and resolution of the geolocation array longitude and latitudes.\n\nice\n\nclass       : SpatRaster \nsize        : 332, 316, 1  (nrow, ncol, nlyr)\nresolution  : 1, 1  (x, y)\nextent      : 0, 316, 0, 332  (xmin, xmax, ymin, ymax)\ncoord. ref. :  \nsource      : CS2WFA_25km_201007.nc:sea_ice_concentration \nvarname     : sea_ice_concentration (sea_ice_area_fraction) \nname        : sea_ice_concentration \nunit        :                     1 \n\npolargrid\n\nclass       : SpatRaster \nsize        : 348, 332, 1  (nrow, ncol, nlyr)\nresolution  : 24999.84, 24999.84  (x, y)\nextent      : -3950080, 4349868, -4337584, 4362361  (xmin, xmax, ymin, ymax)\ncoord. ref. : NSIDC Sea Ice Polar Stereographic South (EPSG:3412) \nsource      : filedb39427e3e998.tif \nname        : filedb39427e3e998 \n\n\nSo, let‚Äôs try to use the same grid.\n\ngdalraster::warp(sds,  tf &lt;- tempfile(fileext = \".tif\", tmpdir = \"/vsimem\"), t_srs = \"EPSG:3412\", \n                cl_arg = c(\"-ts\", 316, 332,\n                           \n                  \"-to\", \"GEOLOC_NORMALIZE_LONGITUDE_MINUS_180_PLUS_180=YES\"))\n\n0...10...20...30...40...50...60...70...80...90...100 - done.\n\npolargrid &lt;- rast(tf)\n\npolargrid\n\nclass       : SpatRaster \nsize        : 332, 316, 1  (nrow, ncol, nlyr)\nresolution  : 26265.66, 26204.65  (x, y)\nextent      : -3950080, 4349868, -4337584, 4362361  (xmin, xmax, ymin, ymax)\ncoord. ref. : NSIDC Sea Ice Polar Stereographic South (EPSG:3412) \nsource      : filedb394ad7590c.tif \nname        : filedb394ad7590c \n\n\nWe can‚Äôt do that without giving them the same extent, but we still don‚Äôt know what that is for the original data. So let‚Äôs calculate it.\n\nxy &lt;- project(values(c(lon, lat)), to = \"EPSG:3412\", from = \"EPSG:4326\")\nrange(xy[,2])\n\n[1] -3937527  4337533"
  },
  {
    "objectID": "posts/2025-09-04_broken-netcdf/index.html#throw-all-that-away-ignore-everything-above.",
    "href": "posts/2025-09-04_broken-netcdf/index.html#throw-all-that-away-ignore-everything-above.",
    "title": "Coordinates broken in NetCDF",
    "section": "Throw all that away, ignore everything above.",
    "text": "Throw all that away, ignore everything above.\nYou should never ever do the above for a dataset that doesn‚Äôt need it. This is a major problem in array computation worlds, there‚Äôs a lowest common denominator that will work but why not be smart about it, and keep fidelity with the original scheme for a dataset.\nThe problem here is that we can‚Äôt reconstruct the actual grid in the file, we have to treat it as points in geolocation arrays, and infer something about the grid. Here‚Äôs the answer:\n\nex &lt;- c(xmin = -3950000,  xmax = 3950000, ymin  = -3950000, ymax = 4350000)\ndiff(ex)[c(1, 3)] / c(316, 332)  ## look familiar?\n\n xmax  ymax \n25000 25000 \n\n\n\nset_ext &lt;- function(x, ex) {terra::ext(x) &lt;- ex; x}\n\nplot(set_ext(ice, ext(ex)))\nplot(v, add = T)\n\n\n\n\n\n\n\nplot(polargrid); plot(v, add = TRUE)\n\n\n\n\n\n\n\n\nNow finally, we get exactly the same answer.\n\ngdalraster::warp(sds,  tf &lt;- tempfile(fileext = \".tif\", tmpdir = \"/vsimem\"), t_srs = \"EPSG:3412\", \n                cl_arg = c(\"-ts\", 316, 332, \"-te\", ex[1], ex[3], ex[2], ex[4],\n                           \n                  \"-to\", \"GEOLOC_NORMALIZE_LONGITUDE_MINUS_180_PLUS_180=YES\"))\n\n0...10...20...30...40...50...60...70...80...90...100 - done.\n\npolargrid &lt;- rast(tf)\n\npolargrid\n\nclass       : SpatRaster \nsize        : 332, 316, 1  (nrow, ncol, nlyr)\nresolution  : 25000, 25000  (x, y)\nextent      : -3950000, 3950000, -3950000, 4350000  (xmin, xmax, ymin, ymax)\ncoord. ref. : NSIDC Sea Ice Polar Stereographic South (EPSG:3412) \nsource      : filedb3946450fee3.tif \nname        : filedb3946450fee3 \n\npolargrid - set_ext(ice, ext(ex))\n\nWarning: [-] CRS do not match\n\n\nclass       : SpatRaster \nsize        : 332, 316, 1  (nrow, ncol, nlyr)\nresolution  : 25000, 25000  (x, y)\nextent      : -3950000, 3950000, -3950000, 4350000  (xmin, xmax, ymin, ymax)\ncoord. ref. : NSIDC Sea Ice Polar Stereographic South (EPSG:3412) \nsource(s)   : memory\nvarname     : filedb3946450fee3 \nname        : filedb3946450fee3 \nmin value   :                 0 \nmax value   :                 0 \n\n# class       : SpatRaster \n# size        : 332, 316, 1  (nrow, ncol, nlyr)\n# resolution  : 25000, 25000  (x, y)\n# extent      : -3950000, 3950000, -3950000, 4350000  (xmin, xmax, ymin, ymax)\n# coord. ref. : NSIDC Sea Ice Polar Stereographic South (EPSG:3412) \n# source(s)   : memory\n# varname     : fileb328ade0cec2 \n# name        : fileb328ade0cec2 \n# min value   :                0 \n# max value   :                0 \n\nBut how did we do that? We plucked some magic numbers out of the air. We can‚Äôt obtain those four numbers from the lon lat arrays, we can‚Äôt find them in the file, they aren‚Äôt in the metadata or the website. We just know, because NSIDC sea ice products are standard on a 3412 grid at 25km resolution.\nThese four numbers: -3950000, 3950000, -3950000, 4350000 are entirely cryptic in the data store itself, and require an expert to notice the problem. We can throw away 332 * 316 * 2 values from every file, replace them with these four values and we have a better and more faithful representation of the original data.\nThis is an entropy problem.\nI refer to this kind of problem as ‚Äúcryptic curvilinear‚Äù. The data present as an irregular grid with curvlinear coordinates, but they are entirely unnecessary, we can replace them with 4 values that anyone can remember and we have the following easy ways to fix, roughly in increasing difficulty and decreasing utility:\n\nset ‚Äú-a_srs‚Äù, and -a_ullr‚Äù in gdal raster convert, or via ‚Äúvrt://{dsn}?a_ullr=,,,‚Äù syntax\nOR set ‚Äú-a_srs‚Äù, and ‚Äú-a_gt‚Äù in gdal raster convert, or via ‚Äúvrt://{dsn}?a_gt=,,,,,‚Äù syntax\nset extent with terra in R and set the crs\nopen with rasterio and set geotransform and set spatial ref (same as set extent with R)\nmodify the coordinates in xarray, and set the crs"
  },
  {
    "objectID": "posts/2025-09-04_broken-netcdf/index.html#oh-but-sure-there-are-bad-files-out-there",
    "href": "posts/2025-09-04_broken-netcdf/index.html#oh-but-sure-there-are-bad-files-out-there",
    "title": "Coordinates broken in NetCDF",
    "section": "Oh, but sure there are bad files out there",
    "text": "Oh, but sure there are bad files out there\nThere are so many.\n\nGHRSST noisy, low precision degenerate rectilinear coordinates\nOISST and NSIDC, have degenerate rectilinear coordinates that don‚Äôt cause problems"
  }
]